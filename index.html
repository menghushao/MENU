<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <title>Order-management ä¸‹æ‹‰é¸å–®æ¸¬è©¦</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    #controls { margin-bottom: 10px; }
    select, button { padding: 6px 10px; margin-right: 10px; }

    table { border-collapse: collapse; margin-top: 10px; }
    th, td {
      border: 1px solid #ccc;
      min-width: 60px;
      height: 24px;
      text-align: center;
    }
    th { background: #eee; position: sticky; top: 0; z-index: 2; }
    th:first-child, td:first-child {
      position: sticky;
      left: 0;
      background: #f3f3f3;
      z-index: 1;
    }
    td:focus { outline: 2px solid #0078D7; }
  </style>
</head>
<body>

<h2>Order-management æ¸¬è©¦é </h2>

<div id="controls">
  <label for="dropdownFromA11toA105">ğŸ”½ A11 ~ A105 ä¸‹æ‹‰é¸å–®ï¼š</label>
  <select id="dropdownFromA11toA105">
    <option value="">è«‹é¸æ“‡</option>
  </select>
  <button onclick="updateDropdownFromA11toA105()">ğŸ”„ é‡æ–°æ“·å–</button>
</div>

<table id="grid">
  <thead>
    <tr id="theadRow"><th></th></tr>
  </thead>
  <tbody id="tbody"></tbody>
</table>

<script>
const ROWS = 106, COLS = 50;
const theadRow = document.getElementById('theadRow');
const tbody = document.getElementById('tbody');

// å»ºç«‹è¡¨é ­ï¼ˆA ~ AXï¼‰
for (let c = 0; c < COLS; c++) {
  let label = '', n = c;
  while (n >= 0) {
    label = String.fromCharCode(n % 26 + 65) + label;
    n = Math.floor(n / 26) - 1;
  }
  const th = document.createElement('th');
  th.textContent = label;
  theadRow.appendChild(th);
}

// å»ºç«‹è¡¨æ ¼å…§å®¹
for (let r = 0; r < ROWS; r++) {
  const tr = document.createElement('tr');
  const rowTh = document.createElement('th');
  rowTh.textContent = r + 1;
  tr.appendChild(rowTh);

  for (let c = 0; c < COLS; c++) {
    const td = document.createElement('td');
    td.contentEditable = true;
    tr.appendChild(td);
  }
  tbody.appendChild(tr);
}

// æ“·å– A11~A105 â†’ ä¸‹æ‹‰é¸å–®
function updateDropdownFromA11toA105() {
  const select = document.getElementById("dropdownFromA11toA105");
  const values = new Set();

  for (let r = 10; r <= 104; r++) {
    const cell = tbody.rows[r]?.cells[1]; // A æ¬„ = cellIndex 1
    const val = cell?.textContent.trim();
    if (val) values.add(val);
  }

  select.innerHTML = '<option value="">è«‹é¸æ“‡</option>';
  Array.from(values).forEach(v => {
    const option = document.createElement('option');
    option.value = option.textContent = v;
    select.appendChild(option);
  });
}

// é é¢è¼‰å…¥å®Œæˆå¾Œè‡ªå‹•åŸ·è¡Œ
window.addEventListener("load", updateDropdownFromA11toA105);
</script>

</body>
</html>
